---
layout: project-page
title: "FM²FVI: Flow Matching for Fast Video Inpainting"
permalink: /papers/vid_inpainting/
custom_css: /assets/css/style_paper.css
---

<div class="container" style="text-align:center; padding-top:2rem">
  <!-- Your content starting from here, without <!DOCTYPE>, <html>, <head>, <body> -->
  ...
</div>---
<!DOCTYPE html>
<html lang="en">
<head>
 <title>Fast Video Inpainting on a Budget</title>
 <meta name="description" content="Fast Video Inpainting on a Budget"/>
 <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes">
 <meta charset="utf-8">
 <!-- <link rel="icon" href="./icon_unicorn.png" type="image/png"> -->

 <!--Facebook-->
 <meta property="og:image" content="">
 <meta property="og:image:type" content="image/jpg">
 <meta property="og:image:width" content="600">
 <meta property="og:image:height" content="400">
 <meta property="og:type" content="website"/>
 <meta property="og:url" content="https://anttwo.github.io/sugar/"/>
 <meta property="og:title" content="SuGaR"/>
 <meta property="og:description" content="Project page for SuGaR: Surface-Aligned Gaussian Splatting for Efficient 3D Mesh Reconstruction and High-Quality Mesh Rendering."/>

 <!--Twitter-->
 <meta name="twitter:card" content="summary_large_image" />
 <meta name="twitter:title" content="SuGaR" />
 <meta property="twitter:description" content="SuGaR: Surface-Aligned Gaussian Splatting for Efficient 3D Mesh Reconstruction and High-Quality Mesh Rendering."/>
 <meta name="twitter:image" content="">

 <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
 <!-- <link href="https://fonts.googleapis.com/css?family=Montserrat:800|Roboto:400,700" rel="stylesheet"> -->
 <link rel="preconnect" href="https://fonts.googleapis.com">
 <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> 
 <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet"> 
 <!-- <link href="http://fonts.googleapis.com/css?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">  -->
 
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
 <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

 <!-- <link href="style_2.css" rel="stylesheet"> -->
 <!-- <link href="../base.css" rel="stylesheet"> -->

<!--  Google Analytics (DO NOT copy/paste following section, setup your own analytics tag at https://analytics.google.com/analytics/web/)  -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-CDL4R10HKE"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-CDL4R10HKE');
</script>
<!-- End Google Analytics -->

<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">

<link rel="stylesheet" href="/assets/css/beforeafter.css">
<script src="/assets/js/beforeafter.js" defer></script>

</head>
<body>

<div class="container" style="text-align:center; padding-top:2rem 15px">
 <div class="row" style="text-align:center">
   <h1 style="font-size: 60px;">FM²FVI: Flow Matching for Fast Multi-frame Video Inpainting</h1>
 </div>
 <div class="row" style="text-align:center">
   <div ></div>
   <div >
     <h4 style="font-size: 22px;">
       <nobr><a href="https://mathis-wauquiez.github.io/">Mathis Wauquiez</a></nobr> &emsp;
       <nobr><a href="https://perso.telecom-paristech.fr/gousseau/">Yann Gousseau</a></nobr>&emsp;
       <nobr><a href="https://sites.google.com/site/alasdairnewson/">Alasdair Newson</a></nobr> &emsp;
       <nobr><a href="https://helios2.mi.parisdescartes.fr/~aalmansa/HomePage/">Andrés Almansa</a></nobr>

     </h4>
     <p style="font-size: 20px; text-align: center;"><nobr>LTCI, Télécom Paris</nobr>, <nobr>ISIR, Sorbonne Université</nobr>, MAP5, Université Paris Descartes<br></p>
   </div>
   <!-- <div class="hidden-xs hidden-sm col-md-1" style="text-align:left; margin-left:0px; margin-right:0px">
     <a href="https://arxiv.org/abs/2303.03315" style="color:#448D87">
       <i class="fa fa-file-pdf-o fa-4x"></i></a>
   </div>
   <div class="hidden-xs hidden-sm col-md-1" style="text-align:left; margin-left:0px;">
     <a href="https://github.com/Anttwo/SuGaR" style="color:#448D87">
       <i class="fa fa-github fa-4x"></i></a>
   </div> -->
 </div>
</div>

<div class="container" style="text-align:center; padding:0rem">
 <div class="row">
   <div class="col-xs-12">
   <h3 style="text-align:center; padding-bottom:1rem">
     <a class="label label-info" href="/files/misc/FM2FVi/fm2fvi_report.pdf"><i class="fa fa-file-text"></i>&nbsp;&nbsp;Report</a>
     <a class="label label-info" href="https://github.com/mathis-wauquiez/VideoInpainting"><i class="fa fa-code fa-lg" style="vertical-align: top; margin-top: 6px"></i>&nbsp;&nbsp;Code</a>
     <!-- <a class="label label-info" href="https://github.com/Anttwo/sugar_frosting_blender_addon/"><i class="fa fa-gamepad fa-lg" style="vertical-align:top; margin-top:5px"></i>&nbsp;&nbsp;Blender Add-On</a> -->
     <!-- <a class="label label-info" href="https://youtu.be/8_QNKaCyr4Y"><i class="fa fa-area-chart fa-lg" style="vertical-align:top;margin-top:6px"></i>&nbsp;&nbsp;Presentation</a> -->
     <!-- <a class="label label-info" href="./ref.bib"><i class="fa fa-commenting fa-lg" style="vertical-align:top;margin-top:6px"></i>&nbsp;&nbsp;BibTeX</a> -->
   </h3>
   </div>
 </div>


<div class="row" style="text-align:center; margin-top:1.5rem;">
  <div class="col-xs-12">
    <div class="ba" data-ba-initial="0.5" aria-label="Before / After video comparison" style="max-width:960px; margin:0 auto;">
      <div class="frame">
        <div class="layer before">
          <video id="videoBefore" data-ba-before playsinline muted loop preload="auto" style="width:100%; height:100%;">
            <source src="/files/misc/FM2FVi/gt_chatelet.mp4" type="video/mp4">
          </video>
        </div>
        <div class="layer after">
          <video id="videoAfter" data-ba-after playsinline muted loop preload="auto" style="width:100%; height:100%;">
            <source src="/files/misc/FM2FVi/mchatelet_16.mp4" type="video/mp4">
          </video>
        </div>
        <div class="handle" role="slider" aria-label="Comparison handle" aria-valuemin="0" aria-valuemax="100">
          <div class="knob" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M8 12h8" stroke="#000" stroke-width="1.6" stroke-linecap="round"/>
              <path d="M12 8v8" stroke="#000" stroke-width="1.6" stroke-linecap="round"/>
            </svg>
          </div>
        </div>
        <div class="label before">Original</div>
        <div class="label after">Inpainted</div>
      </div>
    </div>
  </div>
</div>

<script>
const vidBefore = document.getElementById('videoBefore');
const vidAfter = document.getElementById('videoAfter');

function playVideos() {
  vidBefore.muted = true;
  vidAfter.muted = true;
  Promise.all([vidBefore.play(), vidAfter.play()]).catch(e => {});
}

// Smooth sync function
function syncVideos() {
  const diff = vidBefore.currentTime - vidAfter.currentTime;
  if (Math.abs(diff) > 0.05) { // only correct if off by more than 0.3s
    vidAfter.currentTime = vidBefore.currentTime;
  }
  requestAnimationFrame(syncVideos);
}

window.addEventListener('load', () => {
  playVideos();
  requestAnimationFrame(syncVideos);
});
</script>

<div class="row" style="text-align:center; margin-top:1.5rem;">
  <div class="col-xs-12">
    <div class="ba" data-ba-initial="0.5" aria-label="Before / After video comparison" style="max-width:960px; margin:0 auto;">
      <div class="frame">
        <div class="layer before">
          <video id="videoBefore2" data-ba-before playsinline muted loop preload="auto" style="width:100%; height:100%;">
            <source src="/files/misc/FM2FVi/gt_loulous.mp4" type="video/mp4">
          </video>
        </div>
        <div class="layer after">
          <video id="videoAfter2" data-ba-after playsinline muted loop preload="auto" style="width:100%; height:100%;">
            <source src="/files/misc/FM2FVi/lesloulous_supposedly_good.mp4" type="video/mp4">
          </video>
        </div>
        <div class="handle" role="slider" aria-label="Comparison handle" aria-valuemin="0" aria-valuemax="100">
          <div class="knob" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M8 12h8" stroke="#000" stroke-width="1.6" stroke-linecap="round"/>
              <path d="M12 8v8" stroke="#000" stroke-width="1.6" stroke-linecap="round"/>
            </svg>
          </div>
        </div>
        <div class="label before">Original</div>
        <div class="label after">Inpainted</div>
      </div>
    </div>
  </div>
</div>

<script>
const vidBefore2 = document.getElementById('videoBefore2');
const vidAfter2 = document.getElementById('videoAfter2');

function playVideos() {
  vidBefore2.muted = true;
  vidAfter2.muted = true;
  Promise.all([vidBefore2.play(), vidAfter2.play()]).catch(e => {});
}

// Smooth sync function
function syncVideos() {
  const diff = vidBefore2.currentTime - vidAfter2.currentTime;
  if (Math.abs(diff) > 0.05) { // only correct if off by more than 0.3s
    vidAfter2.currentTime = vidBefore2.currentTime;
  }
  requestAnimationFrame(syncVideos);
}

window.addEventListener('load', () => {
  playVideos();
  requestAnimationFrame(syncVideos);
});
</script>

 <!-- <div class="row" style="padding:2rem">
   <div class="col-xs-12">
   <img src="https://anttwo.github.io/sugar/results/full_teaser.png" alt="full_teaser.png" class="text-center" style="width: 99%; max-width: 1920px">
   <div class="wrapper">
      <p style="text-align: justify">
        <br> We introduce a method that extracts <b>accurate and editable meshes</b> from <b>3D Gaussian Splatting</b> representations <b>within minutes on a single GPU</b>.  
        The meshes can be <b>edited, animated, composited</b>, etc. with very realistic <b>Gaussian Splatting rendering</b>, offering new possibilities for Computer Graphics. 
        Note for example that we changed the posture of the robot between the captured scene on the bottom left and the composited scene on the right, 
        all rendered using Gaussian Splatting rasterizer.  </p>
   </div>
   </div>
 </div> -->

  <!-- <iframe class="embed-responsive-item text-center" src="https://www.youtube.com/embed/MAkFyWfiBQo?si=mIN-4Wk3P2sWBG7C" frameborder="0"
          allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
          style="width:100%; height:620px; clip-path:inset(1px 1px);" allowfullscreen></iframe>    -->

</div>


<div class="container">
  <h2>Abstract</h2>
  <hr/>
  <p>
    Removing an unwanted object from an image now takes just a few seconds on a smartphone. 
    Doing the same on a video can require <b>tens of minutes of computation on a modern GPU</b>. 
    This accessibility gap is no coincidence: video inpainting relies predominantly on diffusion models 
    whose computational cost grows linearly with the temporal dimension.<br>
    <br>
    We propose <b>FM²FVI</b>, a <b>frugal approach to video inpainting</b> based on 
    <a href="https://arxiv.org/pdf/2412.06264">Flow Matching</a>, a recent generative modeling framework 
    closely related to diffusion models. Flow Matching offers several advantages: 
    <b>mathematical simplicity</b>, the ability to handle <b>non-Gaussian source distributions</b>, 
    connections to <b>optimal transport</b>, and most importantly, <b>fast sampling</b> with fewer function evaluations.<br>
    <br>
    Our first contribution is a <b>complete and modular library</b> for training Flow Matching models, 
    supporting all state-of-the-art parameterizations including schedulers, sampling strategies, 
    loss functions, ODE solvers, and guidance modes.<br>
    <br>
    We then develop <b>two image inpainting methodologies</b> based solely on <b>image self-similarity</b>, 
    avoiding priors from large datasets that may raise ethical or legal concerns.<br>
    <br>
    Finally, we extend our most promising approach to <b>video inpainting</b>, demonstrating that 
    it is possible to achieve <b>visually satisfying results</b> with a model using 
    <b>fewer than 500,000 parameters</b>, trained on a single video. 
    This represents a significant step toward <b>democratizing video editing</b> 
    on consumer hardware while reducing <b>energy consumption and environmental impact</b>.
  </p>
</div>
 <p><br></p>

 <h2>FMFVI: <b style="color:#448D87">F</b>low
   <b style="color:#448D87">M</b>atching for 
   <b style="color:#448D87">F</b>ast
    <b style="color:#448D87">V</b>ideo
    <b style="color:#448D87">I</b>npainting 
   <!-- and High-Quality Mesh Rendering -->
 </h2>
 <hr/>
 


<!-- Dark mode toggle -->
<script>
  const themeToggle = document.createElement('button');
  themeToggle.className = 'theme-toggle';
  themeToggle.innerHTML = '<span class="material-icons-outlined">dark_mode</span>';

  themeToggle.addEventListener('click', () => {
      const currentTheme = document.documentElement.getAttribute('data-theme');
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      document.documentElement.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
      themeToggle.innerHTML = newTheme === 'dark' ? '<span class="material-icons-outlined">light_mode</span>' : '<span class="material-icons-outlined">dark_mode</span>';
  });

  // Check for saved theme preference
  const savedTheme = localStorage.getItem('theme') || 'dark';
  document.documentElement.setAttribute('data-theme', savedTheme);
  themeToggle.innerHTML = savedTheme === 'dark' ? '<span class="material-icons-outlined">light_mode</span>' : '<span class="material-icons-outlined">dark_mode</span>';

  document.body.appendChild(themeToggle);
</script>

</body>
</html>
